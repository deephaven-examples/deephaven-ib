<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <link rel="shortcut icon" href="../../_static/favicon.svg"/><meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>deephaven.table - deephaven_ib documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">deephaven_ib  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">deephaven_ib  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules.html">Python Modules</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../code/deephaven_server.html">deephaven_server</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven_server.server.html">server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven_server.start_jvm.html">start_jvm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../code/deephaven_ib.html">deephaven_ib</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven_ib.time.html">time</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../code/deephaven.html">deephaven</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.agg.html">agg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.appmode.html">appmode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.calendar.html">calendar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.column.html">column</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.config.html">config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.constants.html">constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.csv.html">csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.dherror.html">dherror</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.dtypes.html">dtypes</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.experimental.html">experimental</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.experimental.ema.html">ema</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.filters.html">filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.html.html">html</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.jcompat.html">jcompat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.learn.html">learn</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.learn.gather.html">gather</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.liveness_scope.html">liveness_scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.numpy.html">numpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.pandas.html">pandas</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.pandasplugin.html">pandasplugin</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.pandasplugin.pandas_as_table.html">pandas_as_table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.parquet.html">parquet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.perfmon.html">perfmon</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.plot.html">plot</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.axisformat.html">axisformat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.axistransform.html">axistransform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.color.html">color</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.figure.html">figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.font.html">font</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.linestyle.html">linestyle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.plotstyle.html">plotstyle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.selectable_dataset.html">selectable_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plot.shape.html">shape</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.plugin.html">plugin</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.plugin.object.html">object</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.query_library.html">query_library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.replay.html">replay</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.server.html">server</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../code/deephaven.server.plugin.html">plugin</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/deephaven.server.plugin.object.html">object</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/deephaven.server.plugin.register.html">register</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../code/deephaven.server.script_session.html">script_session</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../code/deephaven.stream.html">stream</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../code/deephaven.stream.kafka.html">kafka</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../code/deephaven.stream.kafka.cdc.html">cdc</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/deephaven.stream.kafka.consumer.html">consumer</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../code/deephaven.stream.kafka.producer.html">producer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.table.html">table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.table_factory.html">table_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.table_listener.html">table_listener</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.time.html">time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.ugp.html">ugp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.updateby.html">updateby</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../code/deephaven.uri.html">uri</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../code/jpy.html">jpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code/ibapi.contract.html">ibapi.contract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../code/ibapi.order.html">ibapi.order</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../py-modindex.html">Module Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for deephaven.table</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright (c) 2016-2022 Deephaven Data Labs and Patent Pending</span>
<span class="c1">#</span>

<span class="sd">""" This module implements the Table, PartitionedTable and PartitionedTableProxy classes which are the main</span>
<span class="sd">instruments for working with Deephaven refreshing and static data. """</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="k">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">auto</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Callable</span>

<span class="kn">import</span> <span class="nn">jpy</span>

<span class="kn">from</span> <span class="nn">deephaven</span> <span class="k">import</span> <span class="n">DHError</span><span class="p">,</span> <span class="n">dtypes</span>
<span class="kn">from</span> <span class="nn">deephaven._wrapper</span> <span class="k">import</span> <span class="n">JObjectWrapper</span>
<span class="kn">from</span> <span class="nn">deephaven.agg</span> <span class="k">import</span> <span class="n">Aggregation</span>
<span class="kn">from</span> <span class="nn">deephaven.column</span> <span class="k">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">ColumnType</span>
<span class="kn">from</span> <span class="nn">deephaven.filters</span> <span class="k">import</span> <span class="n">Filter</span>
<span class="kn">from</span> <span class="nn">deephaven.jcompat</span> <span class="k">import</span> <span class="n">j_array_list</span><span class="p">,</span> <span class="n">to_sequence</span><span class="p">,</span> <span class="n">j_unary_operator</span><span class="p">,</span> <span class="n">j_binary_operator</span>
<span class="kn">from</span> <span class="nn">deephaven.ugp</span> <span class="k">import</span> <span class="n">auto_locking_ctx</span>
<span class="kn">from</span> <span class="nn">deephaven.updateby</span> <span class="k">import</span> <span class="n">UpdateByOperation</span>

<span class="c1"># Table</span>
<span class="n">_JTableTools</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.util.TableTools"</span><span class="p">)</span>
<span class="n">_JColumnName</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.ColumnName"</span><span class="p">)</span>
<span class="n">_JSortColumn</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.SortColumn"</span><span class="p">)</span>
<span class="n">_JFilter</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.filter.Filter"</span><span class="p">)</span>
<span class="n">_JFilterOr</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.filter.FilterOr"</span><span class="p">)</span>
<span class="n">_JAsOfMatchRule</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.Table$AsOfMatchRule"</span><span class="p">)</span>
<span class="n">_JPair</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.agg.Pair"</span><span class="p">)</span>
<span class="n">_JMatchPair</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.MatchPair"</span><span class="p">)</span>
<span class="n">_JLayoutHintBuilder</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.util.LayoutHintBuilder"</span><span class="p">)</span>

<span class="c1"># PartitionedTable</span>
<span class="n">_JPartitionedTable</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.PartitionedTable"</span><span class="p">)</span>
<span class="n">_JPartitionedTableFactory</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.PartitionedTableFactory"</span><span class="p">)</span>
<span class="n">_JTableDefinition</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.TableDefinition"</span><span class="p">)</span>
<span class="n">_JPartitionedTableProxy</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.PartitionedTable$Proxy"</span><span class="p">)</span>
<span class="n">_JJoinMatch</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.JoinMatch"</span><span class="p">)</span>
<span class="n">_JJoinAddition</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.JoinAddition"</span><span class="p">)</span>
<span class="n">_JAsOfJoinRule</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.AsOfJoinRule"</span><span class="p">)</span>
<span class="n">_JReverseAsOfJoinRule</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.ReverseAsOfJoinRule"</span><span class="p">)</span>
<span class="n">_JTableOperations</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.api.TableOperations"</span><span class="p">)</span>

<span class="c1"># Dynamic Query Scope</span>
<span class="n">_JExecutionContext</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.context.ExecutionContext"</span><span class="p">)</span>
<span class="n">_JQueryScope</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.context.QueryScope"</span><span class="p">)</span>
<span class="n">_JUnsynchronizedScriptSessionQueryScope</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span>
    <span class="s2">"io.deephaven.engine.util.AbstractScriptSession$UnsynchronizedScriptSessionQueryScope"</span><span class="p">)</span>
<span class="n">_JPythonScriptSession</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.integrations.python.PythonDeephavenSession"</span><span class="p">)</span>
<span class="n">_j_script_session</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_JExecutionContext</span><span class="o">.</span><span class="n">getContext</span><span class="p">()</span><span class="o">.</span><span class="n">getQueryScope</span><span class="p">(),</span> <span class="n">_JUnsynchronizedScriptSessionQueryScope</span><span class="p">)</span><span class="o">.</span><span class="n">scriptSession</span><span class="p">()</span>
<span class="n">_j_py_script_session</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">_j_script_session</span><span class="p">,</span> <span class="n">_JPythonScriptSession</span><span class="p">)</span>


<span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">_query_scope_ctx</span><span class="p">():</span>
    <span class="sd">"""A context manager to set/unset query scope based on the scope of the most immediate caller code that invokes</span>
<span class="sd">    Table operations."""</span>

    <span class="c1"># locate the innermost Deephaven frame (i.e. any of the table operation methods that use this context manager)</span>
    <span class="n">outer_frames</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getouterframes</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outer_frames</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">filename</span> <span class="o">==</span> <span class="vm">__file__</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># combine the immediate caller's globals and locals into a single dict and use it as the query scope</span>
    <span class="n">caller_frame</span> <span class="o">=</span> <span class="n">outer_frames</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span>
    <span class="n">function</span> <span class="o">=</span> <span class="n">outer_frames</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">function</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outer_frames</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">function</span> <span class="o">!=</span> <span class="s2">"&lt;module&gt;"</span><span class="p">:</span>
        <span class="n">scope_dict</span> <span class="o">=</span> <span class="n">caller_frame</span><span class="o">.</span><span class="n">f_globals</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">scope_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">caller_frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_j_py_script_session</span><span class="o">.</span><span class="n">pushScope</span><span class="p">(</span><span class="n">scope_dict</span><span class="p">)</span>
            <span class="k">yield</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">_j_py_script_session</span><span class="o">.</span><span class="n">popScope</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># in the __main__ module, use the default main global scope</span>
        <span class="k">yield</span>


<div class="viewcode-block" id="SortDirection"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.SortDirection">[docs]</a><span class="k">class</span> <span class="nc">SortDirection</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">"""An enum defining the sorting orders."""</span>
    <span class="n">DESCENDING</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="sd">""""""</span>
    <span class="n">ASCENDING</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>
    <span class="sd">""""""</span></div>


<div class="viewcode-block" id="AsOfMatchRule"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.AsOfMatchRule">[docs]</a><span class="k">class</span> <span class="nc">AsOfMatchRule</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">"""An enum defining matching rules on the final column to match by in as-of join and reverse as-of join</span>
<span class="sd">    operation. """</span>
    <span class="n">LESS_THAN_EQUAL</span> <span class="o">=</span> <span class="n">_JAsOfMatchRule</span><span class="o">.</span><span class="n">LESS_THAN_EQUAL</span>
    <span class="n">LESS_THAN</span> <span class="o">=</span> <span class="n">_JAsOfMatchRule</span><span class="o">.</span><span class="n">LESS_THAN</span>
    <span class="n">GREATER_THAN_EQUAL</span> <span class="o">=</span> <span class="n">_JAsOfMatchRule</span><span class="o">.</span><span class="n">GREATER_THAN_EQUAL</span>
    <span class="n">GREATER_THAN</span> <span class="o">=</span> <span class="n">_JAsOfMatchRule</span><span class="o">.</span><span class="n">GREATER_THAN</span></div>


<span class="k">def</span> <span class="nf">_sort_column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">dir_</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">_JSortColumn</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="n">_JColumnName</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">col</span><span class="p">))</span> <span class="k">if</span> <span class="n">dir_</span> <span class="o">==</span> <span class="n">SortDirection</span><span class="o">.</span><span class="n">DESCENDING</span> <span class="k">else</span> <span class="n">_JSortColumn</span><span class="o">.</span><span class="n">asc</span><span class="p">(</span>
        <span class="n">_JColumnName</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">col</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">_td_to_columns</span><span class="p">(</span><span class="n">table_definition</span><span class="p">):</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">j_cols</span> <span class="o">=</span> <span class="n">table_definition</span><span class="o">.</span><span class="n">getColumnsArray</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j_col</span> <span class="ow">in</span> <span class="n">j_cols</span><span class="p">:</span>
        <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Column</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">j_col</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
                <span class="n">data_type</span><span class="o">=</span><span class="n">dtypes</span><span class="o">.</span><span class="n">from_jtype</span><span class="p">(</span><span class="n">j_col</span><span class="o">.</span><span class="n">getDataType</span><span class="p">()),</span>
                <span class="n">component_type</span><span class="o">=</span><span class="n">dtypes</span><span class="o">.</span><span class="n">from_jtype</span><span class="p">(</span><span class="n">j_col</span><span class="o">.</span><span class="n">getComponentType</span><span class="p">()),</span>
                <span class="n">column_type</span><span class="o">=</span><span class="n">ColumnType</span><span class="p">(</span><span class="n">j_col</span><span class="o">.</span><span class="n">getColumnType</span><span class="p">()),</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">cols</span>


<div class="viewcode-block" id="Table"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table">[docs]</a><span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">JObjectWrapper</span><span class="p">):</span>
    <span class="sd">"""A Table represents a Deephaven table. It allows applications to perform powerful Deephaven table operations.</span>

<span class="sd">    Note: It should not be instantiated directly by user code. Tables are mostly created by factory methods,</span>
<span class="sd">    data ingestion operations, queries, aggregations, joins, etc.</span>

<span class="sd">    """</span>

    <span class="n">j_object_type</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="s2">"io.deephaven.engine.table.Table"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j_table</span><span class="p">:</span> <span class="n">jpy</span><span class="o">.</span><span class="n">JType</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">j_table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_object_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="s2">"j_table type is not io.deephaven.engine.table.Table"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">getDefinition</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">default_repr</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
        <span class="c1"># default_repr is in a format like so:</span>
        <span class="c1"># deephaven.table.Table(io.deephaven.engine.table.Table(objectRef=0x7f07e4890518))</span>
        <span class="c1"># We take the last two brackets off, add a few more details about the table, then add the necessary brackets back</span>
        <span class="n">column_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">data_type</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">10</span><span class="p">]}</span>
        <span class="n">repr_str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">f</span><span class="s2">"</span><span class="si">{default_repr[:-2]}</span><span class="s2">, num_rows = </span><span class="si">{self.size}</span><span class="s2">, columns = </span><span class="si">{column_dict}</span><span class="s2">"</span>
        <span class="p">)</span>
        <span class="c1"># We need to add the two brackets back, and also truncate it to be 120 char total (118 + two brackets)</span>
        <span class="n">repr_str</span> <span class="o">=</span> <span class="n">repr_str</span><span class="p">[:</span><span class="mi">114</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"...}))"</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">repr_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">118</span> <span class="k">else</span> <span class="n">repr_str</span> <span class="o">+</span> <span class="s2">"))"</span>
        <span class="k">return</span> <span class="n">repr_str</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">"""The current number of rows in the table."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_refreshing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""Whether this table is refreshing."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">isRefreshing</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">]:</span>
        <span class="sd">"""The column definitions of the table."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="n">_td_to_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">meta_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The column definitions of the table in a Table form. """</span>
        <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">getMeta</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">j_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jpy</span><span class="o">.</span><span class="n">JType</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span>

<div class="viewcode-block" id="Table.to_string"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">"""Returns the first few rows of a table as a pipe-delimited string.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the beginning of the table</span>
<span class="sd">            cols (Union[str, Sequence[str]]): the column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            string</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_JTableTools</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table to_string failed"</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.coalesce"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.coalesce">[docs]</a>    <span class="k">def</span> <span class="nf">coalesce</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""Returns a coalesced child table."""</span>
        <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">coalesce</span><span class="p">())</span></div>

<div class="viewcode-block" id="Table.snapshot"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.snapshot">[docs]</a>    <span class="k">def</span> <span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">do_init</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""Produces an in-memory copy of a source table that refreshes when this table changes.</span>

<span class="sd">        Note, this table is often a time table that adds new rows at a regular, user-defined interval.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_table (Table): the table to be snapshot</span>
<span class="sd">            do_init (bool): whether to snapshot when this method is initially called, default is False</span>
<span class="sd">            cols (Union[str, List[str]]): names of the columns of this table to be included in the snapshot, default is</span>
<span class="sd">                None, meaning all the columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="n">source_table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="n">do_init</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">"failed to create a snapshot table."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.snapshot_history"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.snapshot_history">[docs]</a>    <span class="k">def</span> <span class="nf">snapshot_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_table</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""Produces an in-memory history of a source table that adds a new snapshot when this table (trigger table)</span>
<span class="sd">        changes.</span>

<span class="sd">        The trigger table is often a time table that adds new rows at a regular, user-defined interval.</span>

<span class="sd">        Columns from the trigger table appear in the result table. If the trigger and source tables have columns with</span>
<span class="sd">        the same name, an error will be raised. To avoid this problem, rename conflicting columns.</span>

<span class="sd">        Because snapshot_history stores a copy of the source table for every trigger event, large source tables or</span>
<span class="sd">        rapidly changing trigger tables can result in large memory usage.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_table (Table): the table to be snapshot</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">snapshotHistory</span><span class="p">(</span><span class="n">source_table</span><span class="o">.</span><span class="n">j_table</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">"failed to create a snapshot history table."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="c1">#</span>
    <span class="c1"># Table operation category: Select</span>
    <span class="c1">#</span>
    <span class="c1"># region Select</span>
<div class="viewcode-block" id="Table.drop_columns"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.drop_columns">[docs]</a>    <span class="k">def</span> <span class="nf">drop_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The drop_columns method creates a new table with the same size as this table but omits any of specified</span>
<span class="sd">        columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            cols (Union[str, Sequence[str]): the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">dropColumns</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table drop_columns operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.move_columns"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.move_columns">[docs]</a>    <span class="k">def</span> <span class="nf">move_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The move_columns method creates a new table with specified columns moved to a specific column index value.</span>

<span class="sd">        Args:</span>
<span class="sd">            idx (int): the column index where the specified columns will be moved in the new table.</span>
<span class="sd">            cols (Union[str, Sequence[str]]) : the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">moveColumns</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table move_columns operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.move_columns_down"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.move_columns_down">[docs]</a>    <span class="k">def</span> <span class="nf">move_columns_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The move_columns_down method creates a new table with specified columns appearing last in order, to the far</span>
<span class="sd">        right.</span>

<span class="sd">        Args:</span>
<span class="sd">            cols (Union[str, Sequence[str]]) : the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">moveColumnsDown</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table move_columns_down operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.move_columns_up"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.move_columns_up">[docs]</a>    <span class="k">def</span> <span class="nf">move_columns_up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The move_columns_up method creates a new table with specified columns appearing first in order, to the far</span>
<span class="sd">        left.</span>

<span class="sd">        Args:</span>
<span class="sd">            cols (Union[str, Sequence[str]]) : the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">moveColumnsUp</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table move_columns_up operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.rename_columns"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.rename_columns">[docs]</a>    <span class="k">def</span> <span class="nf">rename_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The rename_columns method creates a new table with the specified columns renamed.</span>

<span class="sd">        Args:</span>
<span class="sd">            cols (Union[str, Sequence[str]]) : the column rename expr(s) as "X = Y"</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">renameColumns</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table rename_columns operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.update"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The update method creates a new table containing a new, in-memory column for each formula.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table update operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.lazy_update"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.lazy_update">[docs]</a>    <span class="k">def</span> <span class="nf">lazy_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The lazy_update method creates a new table containing a new, cached, formula column for each formula.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">lazyUpdate</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table lazy_update operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.view"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.view">[docs]</a>    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The view method creates a new formula table that includes one column for each formula.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table view operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.update_view"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.update_view">[docs]</a>    <span class="k">def</span> <span class="nf">update_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The update_view method creates a new table containing a new, formula column for each formula.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">updateView</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table update_view operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.select"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.select">[docs]</a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The select method creates a new in-memory table that includes one column for each formula. If no formula</span>
<span class="sd">        is specified, all columns will be included.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]], optional): the column formula(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">formulas</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">select</span><span class="p">())</span>
                <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table select operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.select_distinct"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.select_distinct">[docs]</a>    <span class="k">def</span> <span class="nf">select_distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The select_distinct method creates a new table containing all of the unique values for a set of key</span>
<span class="sd">        columns. When the selectDistinct method is used on multiple columns, it looks for distinct sets of values in</span>
<span class="sd">        the selected columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]], optional): the column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">selectDistinct</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table select_distinct operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="c1"># endregion</span>

    <span class="c1">#</span>
    <span class="c1"># Table operation category: Filter</span>
    <span class="c1">#</span>
    <span class="c1"># region Filter</span>

<div class="viewcode-block" id="Table.where"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.where">[docs]</a>    <span class="k">def</span> <span class="nf">where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Filter</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Filter</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The where method creates a new table with only the rows meeting the filter criteria in the column(s) of</span>
<span class="sd">        the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            filters (Union[str, Filter, Sequence[str], Sequence[Filter]], optional): the filter condition</span>
<span class="sd">                expression(s) or Filter object(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filters</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">*</span><span class="n">filters</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table where operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.where_in"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.where_in">[docs]</a>    <span class="k">def</span> <span class="nf">where_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The where_in method creates a new table containing rows from the source table, where the rows match</span>
<span class="sd">        values in the filter table. The filter is updated whenever either table changes.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_table (Table): the table containing the set of values to filter on</span>
<span class="sd">            cols (Union[str, Sequence[str]]): the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">whereIn</span><span class="p">(</span><span class="n">filter_table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table where_in operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.where_not_in"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.where_not_in">[docs]</a>    <span class="k">def</span> <span class="nf">where_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The where_not_in method creates a new table containing rows from the source table, where the rows do not</span>
<span class="sd">        match values in the filter table.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_table (Table): the table containing the set of values to filter on</span>
<span class="sd">            cols (Union[str, Sequence[str]]): the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">whereNotIn</span><span class="p">(</span><span class="n">filter_table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table where_not_in operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.where_one_of"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.where_one_of">[docs]</a>    <span class="k">def</span> <span class="nf">where_one_of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The where_one_of method creates a new table containing rows from the source table, where the rows match at</span>
<span class="sd">        least one filter.</span>

<span class="sd">        Args:</span>
<span class="sd">            filters (Union[str, Sequence[str]], optional): the filter condition expression(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filters</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span>
                    <span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">_JFilterOr</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">_JFilter</span><span class="o">.</span><span class="n">from_</span><span class="p">(</span><span class="o">*</span><span class="n">filters</span><span class="p">)))</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table where_one_of operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.head"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.head">[docs]</a>    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The head method creates a new table with a specific number of rows from the beginning of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the head of table</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">num_rows</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table head operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.head_pct"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.head_pct">[docs]</a>    <span class="k">def</span> <span class="nf">head_pct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pct</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The head_pct method creates a new table with a specific percentage of rows from the beginning of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            pct (float): the percentage of rows to return as a value from 0 (0%) to 1 (100%).</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">headPct</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table head_pct operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.tail"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.tail">[docs]</a>    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The tail method creates a new table with a specific number of rows from the end of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the end of table</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">num_rows</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table tail operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.tail_pct"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.tail_pct">[docs]</a>    <span class="k">def</span> <span class="nf">tail_pct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pct</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The tail_pct method creates a new table with a specific percentage of rows from the end of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            pct (float): the percentage of rows to return as a value from 0 (0%) to 1 (100%).</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">tailPct</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table tail_pct operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="c1"># endregion</span>

    <span class="c1">#</span>
    <span class="c1"># Table operation category: Sort</span>
    <span class="c1">#</span>
    <span class="c1"># region Sort</span>
<div class="viewcode-block" id="Table.restrict_sort_to"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.restrict_sort_to">[docs]</a>    <span class="k">def</span> <span class="nf">restrict_sort_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
        <span class="sd">"""The restrict_sort_to method only allows sorting on specified table columns. This can be useful to prevent</span>
<span class="sd">        users from accidentally performing expensive sort operations as they interact with tables in the UI.</span>

<span class="sd">        Args:</span>
<span class="sd">            cols (Union[str, Sequence[str]]): the column name(s)</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">restrictSortTo</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table restrict_sort_to operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.sort_descending"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.sort_descending">[docs]</a>    <span class="k">def</span> <span class="nf">sort_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The sort_descending method creates a new table where rows in a table are sorted in a largest to smallest</span>
<span class="sd">        order based on the order_by column(s).</span>

<span class="sd">        Args:</span>
<span class="sd">            order_by (Union[str, Sequence[str]], optional): the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">order_by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">sortDescending</span><span class="p">(</span><span class="o">*</span><span class="n">order_by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table sort_descending operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.reverse"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.reverse">[docs]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The reverse method creates a new table with all of the rows from this table in reverse order.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">reverse</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table reverse operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.sort"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
             <span class="n">order</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SortDirection</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SortDirection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The sort method creates a new table where the rows are ordered based on values in a specified set of columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            order_by (Union[str, Sequence[str]]): the column(s) to be sorted on</span>
<span class="sd">            order (Union[SortDirection, Sequence[SortDirection], optional): the corresponding sort directions for</span>
<span class="sd">                each sort column, default is None, meaning ascending order for all the sort columns.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">order_by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">order</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="n">SortDirection</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">"The number of sort columns must be the same as the number of sort directions."</span><span class="p">)</span>

            <span class="n">sort_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sort_column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">dir_</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">order_by</span><span class="p">,</span> <span class="n">order</span><span class="p">)]</span>
            <span class="n">j_sc_list</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">sort_columns</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">j_sc_list</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table sort operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="c1"># endregion</span>

    <span class="c1">#</span>
    <span class="c1"># Table operation category: Join</span>
    <span class="c1">#</span>
    <span class="c1"># region Join</span>

<div class="viewcode-block" id="Table.natural_join"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.natural_join">[docs]</a>    <span class="k">def</span> <span class="nf">natural_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
                     <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The natural_join method creates a new table containing all of the rows and columns of this table,</span>
<span class="sd">        plus additional columns containing data from the right table. For columns appended to the left table (joins),</span>
<span class="sd">        row values equal the row values from the right table where the key values in the left and right tables are</span>
<span class="sd">        equal. If there is no matching key in the right table, appended row values are NULL.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): the right-table of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span>
                        <span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">naturalJoin</span><span class="p">(</span>
                            <span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">),</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span>
                        <span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">naturalJoin</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">))</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table natural_join operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.exact_join"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.exact_join">[docs]</a>    <span class="k">def</span> <span class="nf">exact_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The exact_join method creates a new table containing all of the rows and columns of this table plus</span>
<span class="sd">        additional columns containing data from the right table. For columns appended to the left table (joins),</span>
<span class="sd">        row values equal the row values from the right table where the key values in the left and right tables are</span>
<span class="sd">        equal.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): the right-table of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span>
                        <span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">exactJoin</span><span class="p">(</span>
                            <span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">),</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span>
                        <span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">exactJoin</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">))</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table exact_join operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.join"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The join method creates a new table containing rows that have matching values in both tables. Rows that</span>
<span class="sd">        do not have matching criteria will not be included in the result. If there are multiple matches between a row</span>
<span class="sd">        from the left table and rows from the right table, all matching combinations will be included. If no columns</span>
<span class="sd">        to match (on) are specified, every combination of left and right table rows is included.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): the right-table of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names; default is None</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span>
                        <span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">),</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table join operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.aj"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.aj">[docs]</a>    <span class="k">def</span> <span class="nf">aj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
           <span class="n">match_rule</span><span class="p">:</span> <span class="n">AsOfMatchRule</span> <span class="o">=</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">LESS_THAN_EQUAL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The aj (as-of join) method creates a new table containing all of the rows and columns of the left table,</span>
<span class="sd">        plus additional columns containing data from the right table. For columns appended to the left table (joins),</span>
<span class="sd">        row values equal the row values from the right table where the keys from the left table most closely match</span>
<span class="sd">        the keys from the right table without going over. If there is no matching key in the right table, appended row</span>
<span class="sd">        values are NULL.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): the right-table of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>
<span class="sd">            match_rule (AsOfMatchRule): the inexact matching rule on the last column to match specified in 'on',</span>
<span class="sd">                default is AsOfMatchRule.LESS_THAN_EQUAL. The other valid value is AsOfMatchRule.LESS_THAN.</span>
<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">on</span><span class="p">:</span>
                <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JMatchPair</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">_JPair</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                <span class="n">joins</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JMatchPair</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">_JPair</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">]</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">aj</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">match_rule</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table as-of join operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.raj"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.raj">[docs]</a>    <span class="k">def</span> <span class="nf">raj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">match_rule</span><span class="p">:</span> <span class="n">AsOfMatchRule</span> <span class="o">=</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">GREATER_THAN_EQUAL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The reverse-as-of join method creates a new table containing all of the rows and columns of the left table,</span>
<span class="sd">        plus additional columns containing data from the right table. For columns appended to the left table (joins),</span>
<span class="sd">        row values equal the row values from the right table where the keys from the left table most closely match</span>
<span class="sd">        the keys from the right table without going under. If there is no matching key in the right table, appended row</span>
<span class="sd">        values are NULL.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Table): the right-table of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>
<span class="sd">            match_rule (AsOfMatchRule): the inexact matching rule on the last column to match specified in 'on',</span>
<span class="sd">                default is AsOfMatchRule.GREATER_THAN_EQUAL. The other valid value is AsOfMatchRule.GREATER_THAN.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">on</span><span class="p">:</span>
                <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JMatchPair</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">_JPair</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                <span class="n">joins</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JMatchPair</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">_JPair</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">]</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">raj</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">match_rule</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table reverse-as-of join operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="c1"># endregion</span>

    <span class="c1">#</span>
    <span class="c1"># Table operation category: Aggregation</span>
    <span class="c1"># region Aggregation</span>

<div class="viewcode-block" id="Table.head_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.head_by">[docs]</a>    <span class="k">def</span> <span class="nf">head_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The head_by method creates a new table containing the first number of rows for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the beginning of each group</span>
<span class="sd">            by (Union[str, Sequence[str]]): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">headBy</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table head_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.tail_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.tail_by">[docs]</a>    <span class="k">def</span> <span class="nf">tail_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The tail_by method creates a new table containing the last number of rows for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the end of each group</span>
<span class="sd">            by (Union[str, Sequence[str]]): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">tailBy</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table tail_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.group_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.group_by">[docs]</a>    <span class="k">def</span> <span class="nf">group_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The group_by method creates a new table containing grouping columns and grouped data, column content is</span>
<span class="sd">        grouped into arrays.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">groupBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table group-by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.ungroup"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.ungroup">[docs]</a>    <span class="k">def</span> <span class="nf">ungroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The ungroup method creates a new table in which array columns from the source table are unwrapped into</span>
<span class="sd">        separate rows.</span>

<span class="sd">        Args:</span>
<span class="sd">            cols (Union[str, Sequence[str]], optional): the name(s) of the array column(s), if None, all array columns</span>
<span class="sd">                will be ungrouped, default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cols</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">ungroup</span><span class="p">(</span><span class="o">*</span><span class="n">cols</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">ungroup</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table ungroup operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.first_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.first_by">[docs]</a>    <span class="k">def</span> <span class="nf">first_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The first_by method creates a new table containing the first row for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">firstBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">firstBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table first_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.last_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.last_by">[docs]</a>    <span class="k">def</span> <span class="nf">last_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The last_by method creates a new table containing the last row for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">lastBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">lastBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table last_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.sum_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.sum_by">[docs]</a>    <span class="k">def</span> <span class="nf">sum_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The sum_by method creates a new table containing the sum for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">sumBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">sumBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table sum_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.abs_sum_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.abs_sum_by">[docs]</a>    <span class="k">def</span> <span class="nf">abs_sum_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The abs_sum_by method creates a new table containing the absolute sum for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">absSumBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">absSumBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table asb_sum_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.weighted_sum_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.weighted_sum_by">[docs]</a>    <span class="k">def</span> <span class="nf">weighted_sum_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wcol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The weighted_sum_by method creates a new table containing the weighted sum for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            wcol (str): the name of the weight column</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">wsumBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">wsumBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table weighted_sum_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.avg_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.avg_by">[docs]</a>    <span class="k">def</span> <span class="nf">avg_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The avg_by method creates a new table containing the average for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">avgBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">avgBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table avg_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.weighted_avg_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.weighted_avg_by">[docs]</a>    <span class="k">def</span> <span class="nf">weighted_avg_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wcol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The weighted_avg_by method creates a new table containing the weighted average for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            wcol (str): the name of the weight column</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">wavgBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">wavgBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table avg_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.std_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.std_by">[docs]</a>    <span class="k">def</span> <span class="nf">std_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The std_by method creates a new table containing the standard deviation for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">stdBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">stdBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table std_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.var_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.var_by">[docs]</a>    <span class="k">def</span> <span class="nf">var_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The var_by method creates a new table containing the variance for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">varBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">varBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table var_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.median_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.median_by">[docs]</a>    <span class="k">def</span> <span class="nf">median_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The median_by method creates a new table containing the median for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">medianBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">medianBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table median_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.min_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.min_by">[docs]</a>    <span class="k">def</span> <span class="nf">min_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The min_by method creates a new table containing the minimum value for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">minBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">minBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table min_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.max_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.max_by">[docs]</a>    <span class="k">def</span> <span class="nf">max_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The max_by method creates a new table containing the maximum value for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">maxBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">maxBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table max_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.count_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.count_by">[docs]</a>    <span class="k">def</span> <span class="nf">count_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The count_by method creates a new table containing the number of rows for each group.</span>

<span class="sd">        Args:</span>
<span class="sd">            col (str): the name of the column to store the counts</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">countBy</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">countBy</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table count_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.agg_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.agg_by">[docs]</a>    <span class="k">def</span> <span class="nf">agg_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aggs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Aggregation</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Aggregation</span><span class="p">]],</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The agg_by method creates a new table containing grouping columns and grouped data. The resulting</span>
<span class="sd">        grouped data is defined by the aggregations specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            aggs (Union[Aggregation, Sequence[Aggregation]]): the aggregation(s)</span>
<span class="sd">            by (Union[str, Sequence[str]]): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">aggs</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">aggs</span><span class="p">)</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="n">j_agg_list</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">([</span><span class="n">agg</span><span class="o">.</span><span class="n">j_aggregation</span> <span class="k">for</span> <span class="n">agg</span> <span class="ow">in</span> <span class="n">aggs</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">aggBy</span><span class="p">(</span><span class="n">j_agg_list</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table agg_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.agg_all_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.agg_all_by">[docs]</a>    <span class="k">def</span> <span class="nf">agg_all_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agg</span><span class="p">:</span> <span class="n">Aggregation</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The agg_all_by method creates a new table containing grouping columns and grouped data. The resulting</span>
<span class="sd">        grouped data is defined by the aggregation specified.</span>

<span class="sd">        Note, because agg_all_by applies the aggregation to all the columns of the table, it will ignore</span>
<span class="sd">        any column names specified for the aggregation.</span>

<span class="sd">        Args:</span>
<span class="sd">            agg (Aggregation): the aggregation</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">aggAllBy</span><span class="p">(</span><span class="n">agg</span><span class="o">.</span><span class="n">j_agg_spec</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table agg_all_by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="c1"># endregion</span>

<div class="viewcode-block" id="Table.format_columns"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.format_columns">[docs]</a>    <span class="k">def</span> <span class="nf">format_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">""" Applies color formatting to the columns of the table.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, List[str]]): formatting string(s) in the form of "column=color_expression"</span>
<span class="sd">                where color_expression can be a color name or a Java ternary expression that results in a color.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">formatColumns</span><span class="p">(</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to color format columns."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.format_column_where"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.format_column_where">[docs]</a>    <span class="k">def</span> <span class="nf">format_column_where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cond</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">""" Applies color formatting to a column of the table conditionally.</span>

<span class="sd">        Args:</span>
<span class="sd">            col (str): the column name</span>
<span class="sd">            cond (str): the condition expression</span>
<span class="sd">            formula (str): the formatting string in the form of assignment expression "column=color expression"</span>
<span class="sd">                where color_expression can be a color name or a Java ternary expression that results in a color.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">formatColumnWhere</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">formula</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to color format column conditionally."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.format_row_where"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.format_row_where">[docs]</a>    <span class="k">def</span> <span class="nf">format_row_where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">""" Applies color formatting to rows of the table conditionally.</span>

<span class="sd">        Args:</span>
<span class="sd">            cond (str): the condition expression</span>
<span class="sd">            formula (str): the formatting string in the form of assignment expression "column=color expression"</span>
<span class="sd">                where color_expression can be a color name or a Java ternary expression that results in a color.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">formatRowWhere</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">formula</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to color format rows conditionally."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.layout_hints"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.layout_hints">[docs]</a>    <span class="k">def</span> <span class="nf">layout_hints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">front</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">back</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">freeze</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">column_groups</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">""" Sets layout hints on the Table</span>

<span class="sd">        Args:</span>
<span class="sd">            front (Union[str, List[str]]): the columns to show at the front.</span>
<span class="sd">            back (Union[str, List[str]]): the columns to show at the back.</span>
<span class="sd">            freeze (Union[str, List[str]]): the columns to freeze to the front.</span>
<span class="sd">                These will not be affected by horizontal scrolling.</span>
<span class="sd">            hide (Union[str, List[str]]): the columns to hide.</span>
<span class="sd">            column_groups (List[Dict]): A list of dicts specifying which columns should be grouped in the UI</span>
<span class="sd">                The dicts can specify the following:</span>

<span class="sd">                name (str): The group name</span>
<span class="sd">                children (List[str]): The</span>
<span class="sd">                color (Optional[str]): The hex color string or Deephaven color name</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new table with the layout hints set</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_j_layout_hint_builder</span> <span class="o">=</span> <span class="n">_JLayoutHintBuilder</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">front</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_j_layout_hint_builder</span><span class="o">.</span><span class="n">atFront</span><span class="p">(</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">front</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">back</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_j_layout_hint_builder</span><span class="o">.</span><span class="n">atBack</span><span class="p">(</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">back</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">freeze</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_j_layout_hint_builder</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">freeze</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">hide</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_j_layout_hint_builder</span><span class="o">.</span><span class="n">hide</span><span class="p">(</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">hide</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">column_groups</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">column_groups</span><span class="p">:</span>
                    <span class="n">_j_layout_hint_builder</span><span class="o">.</span><span class="n">columnGroup</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"name"</span><span class="p">),</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"children"</span><span class="p">)),</span>
                                                       <span class="n">group</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"color"</span><span class="p">,</span> <span class="s2">""</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to create layout hints"</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">setLayoutHints</span><span class="p">(</span><span class="n">_j_layout_hint_builder</span><span class="o">.</span><span class="n">build</span><span class="p">()))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to set layout hints on table"</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.partition_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.partition_by">[docs]</a>    <span class="k">def</span> <span class="nf">partition_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">drop_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">""" Creates a PartitionedTable from this table, partitioned according to the specified key columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]]): the column(s) by which to group data</span>
<span class="sd">            drop_keys (bool): whether to drop key columns in the constituent tables, default is False</span>

<span class="sd">        Returns:</span>
<span class="sd">            A PartitionedTable containing a sub-table for each group</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">partitionBy</span><span class="p">(</span><span class="n">drop_keys</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to create a partitioned table."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="Table.update_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.Table.update_by">[docs]</a>    <span class="k">def</span> <span class="nf">update_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ops</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UpdateByOperation</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">UpdateByOperation</span><span class="p">]],</span>
                  <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""Creates a table with additional columns calculated from window-based aggregations of columns in this table.</span>
<span class="sd">        The aggregations are defined by the provided operations, which support incremental aggregations over the</span>
<span class="sd">        corresponding rows in the this table. The aggregations will apply position or time-based windowing and</span>
<span class="sd">        compute the results over the entire table or each row group as identified by the provided key columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            ops (Union[UpdateByOperation, List[UpdateByOperation]]): the update-by operation definition(s)</span>
<span class="sd">            by (Union[str, List[str]]): the key column name(s) to group the rows of the table</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new Table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ops</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_table</span><span class="o">.</span><span class="n">updateBy</span><span class="p">(</span><span class="n">j_array_list</span><span class="p">(</span><span class="n">ops</span><span class="p">),</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"table update-by operation failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div></div>


<div class="viewcode-block" id="PartitionedTable"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable">[docs]</a><span class="k">class</span> <span class="nc">PartitionedTable</span><span class="p">(</span><span class="n">JObjectWrapper</span><span class="p">):</span>
    <span class="sd">"""A partitioned table is a table containing tables, known as constituent tables.</span>
<span class="sd">    Each constituent table has the same schema.</span>

<span class="sd">    The partitioned table contains:</span>
<span class="sd">    1. one column containing constituent tables</span>
<span class="sd">    2. key columns (optional)</span>
<span class="sd">    3. non-key columns (optional)</span>

<span class="sd">    Key values can be used to retrieve constituent tables from the partitioned table and</span>
<span class="sd">    can be used to perform operations with other like-keyed partitioned tables.</span>
<span class="sd">    """</span>

    <span class="n">j_object_type</span> <span class="o">=</span> <span class="n">_JPartitionedTable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">j_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jpy</span><span class="o">.</span><span class="n">JType</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j_partitioned_table</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span> <span class="o">=</span> <span class="n">j_partitioned_table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_columns</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unique_keys</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_column</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_changes_permitted</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="PartitionedTable.from_partitioned_table"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.from_partitioned_table">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_partitioned_table</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                               <span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span>
                               <span class="n">key_cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                               <span class="n">unique_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                               <span class="n">constituent_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                               <span class="n">constituent_table_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                               <span class="n">constituent_changes_permitted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">"""Creates a PartitionedTable from the provided underlying partitioned Table.</span>

<span class="sd">        Note: key_cols, unique_keys, constituent_column, constituent_table_columns,</span>
<span class="sd">        constituent_changes_permitted must either be all None or all have values. When they are None, their values will</span>
<span class="sd">        be inferred as follows:</span>
<span class="sd">            key_cols: the names of all columns with a non-Table data type</span>
<span class="sd">            unique_keys: False</span>
<span class="sd">            constituent_column: the name of the first column with a Table data type</span>
<span class="sd">            constituent_table_columns: the column definitions of the first cell (constituent table) in the constituent</span>
<span class="sd">                column. Consequently the constituent column can't be empty</span>
<span class="sd">            constituent_changes_permitted: the value of table.is_refreshing</span>


<span class="sd">        Args:</span>
<span class="sd">            table (Table): the underlying partitioned table</span>
<span class="sd">            key_cols (Union[str, List[str]]): the key column name(s) of 'table'</span>
<span class="sd">            unique_keys (bool): whether the keys in 'table' are guaranteed to be unique</span>
<span class="sd">            constituent_column (str): the constituent column name in 'table'</span>
<span class="sd">            constituent_table_columns (list[Column]): the column definitions of the constituent table</span>
<span class="sd">            constituent_changes_permitted (bool): whether the values of the constituent column can change</span>

<span class="sd">        Returns:</span>
<span class="sd">            a PartitionedTable</span>

<span class="sd">        Raise:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="n">none_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">key_cols</span><span class="p">,</span> <span class="n">unique_keys</span><span class="p">,</span> <span class="n">constituent_column</span><span class="p">,</span> <span class="n">constituent_table_columns</span><span class="p">,</span>
                     <span class="n">constituent_changes_permitted</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">none_args</span><span class="p">]):</span>
                <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="n">_JPartitionedTableFactory</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">none_args</span><span class="p">]):</span>
                <span class="n">table_def</span> <span class="o">=</span> <span class="n">_JTableDefinition</span><span class="o">.</span><span class="n">of</span><span class="p">([</span><span class="n">col</span><span class="o">.</span><span class="n">j_column_definition</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">constituent_table_columns</span><span class="p">])</span>
                <span class="n">j_partitioned_table</span> <span class="o">=</span> <span class="n">_JPartitionedTableFactory</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span>
                                                                   <span class="n">j_array_list</span><span class="p">(</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">key_cols</span><span class="p">)),</span>
                                                                   <span class="n">unique_keys</span><span class="p">,</span>
                                                                   <span class="n">constituent_column</span><span class="p">,</span>
                                                                   <span class="n">table_def</span><span class="p">,</span>
                                                                   <span class="n">constituent_changes_permitted</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="n">j_partitioned_table</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to build a PartitionedTable."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="n">missing_value_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">arg</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">none_args</span> <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">f</span><span class="s2">"invalid argument values, must specify non-None values for </span><span class="si">{missing_value_args}</span><span class="s2">."</span><span class="p">)</span></div>

<div class="viewcode-block" id="PartitionedTable.from_constituent_tables"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.from_constituent_tables">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_constituent_tables</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                                <span class="n">tables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Table</span><span class="p">],</span>
                                <span class="n">constituent_table_columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">"""Creates a PartitionedTable with a single column named '__CONSTITUENT__' containing the provided constituent</span>
<span class="sd">        tables.</span>

<span class="sd">        The result PartitionedTable has no key columns, and both its unique_keys and constituent_changes_permitted</span>
<span class="sd">        properties are set to False. When constituent_table_columns isn't provided, it will be set to the column</span>
<span class="sd">        definitions of the first table in the provided constituent tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            tables (List[Table]): the constituent tables</span>
<span class="sd">            constituent_table_columns (List[Column]): a list of column definitions compatible with all the constituent</span>
<span class="sd">                tables, default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a PartitionedTable</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">constituent_table_columns</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="n">_JPartitionedTableFactory</span><span class="o">.</span><span class="n">ofTables</span><span class="p">(</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">tables</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">table_def</span> <span class="o">=</span> <span class="n">_JTableDefinition</span><span class="o">.</span><span class="n">of</span><span class="p">([</span><span class="n">col</span><span class="o">.</span><span class="n">j_column_definition</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">constituent_table_columns</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="n">_JPartitionedTableFactory</span><span class="o">.</span><span class="n">ofTables</span><span class="p">(</span><span class="n">table_def</span><span class="p">,</span>
                                                                                               <span class="n">to_sequence</span><span class="p">(</span><span class="n">tables</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to create a PartitionedTable from constituent tables."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""The underlying partitioned table."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">table</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_refreshing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""Whether the underlying partitioned table is refreshing."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">is_refreshing</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_refreshing</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">key_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">"""The partition key column names."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_key_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">keyColumnNames</span><span class="p">()</span><span class="o">.</span><span class="n">toArray</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_columns</span>

<div class="viewcode-block" id="PartitionedTable.keys"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""Returns a Table containing all the keys of the underlying partitioned table."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_columns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">select_distinct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_columns</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""Whether the keys in the underlying table must always be unique. If keys must be unique, one can expect</span>
<span class="sd">        that self.table.select_distinct(self.key_columns) and self.table.view(self.key_columns) operations always</span>
<span class="sd">        produce equivalent tables."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unique_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unique_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">uniqueKeys</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unique_keys</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constituent_column</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">"""The name of the column containing constituent tables."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">constituentColumnName</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_column</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constituent_table_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Column</span><span class="p">]:</span>
        <span class="sd">"""The column definitions for constituent tables.  All constituent tables in a partitioned table have the</span>
<span class="sd">        same column definitions."""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span> <span class="o">=</span> <span class="n">_td_to_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">constituentDefinition</span><span class="p">())</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constituent_changes_permitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""Can the constituents of the underlying partitioned table change?  Specifically, can the values of the</span>
<span class="sd">        constituent column change?</span>

<span class="sd">        If constituent changes are not permitted, the underlying partitioned table:</span>
<span class="sd">        1. has no adds</span>
<span class="sd">        2. has no removes</span>
<span class="sd">        3. has no shifts</span>
<span class="sd">        4. has no modifies that include the constituent column</span>

<span class="sd">        Note, it is possible for constituent changes to not be permitted even if constituent tables are refreshing or</span>
<span class="sd">        if the underlying partitioned table is refreshing. Also note that the underlying partitioned table must be</span>
<span class="sd">        refreshing if it contains any refreshing constituents.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_changes_permitted</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_changes_permitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">constituentChangesPermitted</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constituent_changes_permitted</span>

<div class="viewcode-block" id="PartitionedTable.merge"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="sd">"""Makes a new Table that contains all the rows from all the constituent tables. In the merged result,</span>
<span class="sd">        data from a constituent table is contiguous, and data from constituent tables appears in the same order the</span>
<span class="sd">        constituent table appears in the PartitionedTable. Basically, merge stacks constituent tables on top of each</span>
<span class="sd">        other in the same relative order as the partitioned table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Table</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">merge</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to merge all the constituent tables."</span><span class="p">)</span></div>

<div class="viewcode-block" id="PartitionedTable.filter"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.filter">[docs]</a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Filter</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Filter</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">"""The filter method creates a new partitioned table containing only the rows meeting the filter criteria.</span>
<span class="sd">        Filters can not use the constituent column.</span>

<span class="sd">        Args:</span>
<span class="sd">            filters (Union[str, Filter, Sequence[str], Sequence[Filter]]): the filter condition  expression(s) or</span>
<span class="sd">                Filter object(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">             a PartitionedTable</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">filters</span> <span class="o">=</span> <span class="n">Filter</span><span class="o">.</span><span class="n">from_</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
            <span class="n">filters</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">j_array_list</span><span class="p">(</span><span class="n">filters</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to apply filters to the partitioned table."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTable.sort"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
             <span class="n">order</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SortDirection</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SortDirection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">"""The sort method creates a new partitioned table where the rows are ordered based on values in a specified</span>
<span class="sd">        set of columns. Sort can not use the constituent column.</span>

<span class="sd">         Args:</span>
<span class="sd">             order_by (Union[str, Sequence[str]]): the column(s) to be sorted on.  Can't include the constituent column.</span>
<span class="sd">             order (Union[SortDirection, Sequence[SortDirection], optional): the corresponding sort directions for</span>
<span class="sd">                each sort column, default is None, meaning ascending order for all the sort columns.</span>

<span class="sd">         Returns:</span>
<span class="sd">             a new PartitionedTable</span>

<span class="sd">         Raises:</span>
<span class="sd">             DHError</span>
<span class="sd">         """</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">order_by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">order</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="n">SortDirection</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">"The number of sort columns must be the same as the number of sort directions."</span><span class="p">)</span>

            <span class="n">sort_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sort_column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">dir_</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">order_by</span><span class="p">,</span> <span class="n">order</span><span class="p">)]</span>
            <span class="n">j_sc_list</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">sort_columns</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">j_sc_list</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to sort the partitioned table."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTable.get_constituent"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.get_constituent">[docs]</a>    <span class="k">def</span> <span class="nf">get_constituent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
        <span class="sd">"""Gets a single constituent table by its corresponding key column value(s).</span>
<span class="sd">        If there are no matching rows, the result is None. If there are multiple matching rows, a DHError is thrown.</span>

<span class="sd">        Args:</span>
<span class="sd">            key_values (Union[Any, Sequence[Any]]): the value(s) of the key column(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Table or None</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">key_values</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">key_values</span><span class="p">)</span>
            <span class="n">j_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">constituentFor</span><span class="p">(</span><span class="n">key_values</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j_table</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">(</span><span class="n">j_table</span><span class="o">=</span><span class="n">j_table</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"unable to get constituent table."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constituent_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
        <span class="sd">"""Returns all the current constituent tables."""</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">constituents</span><span class="p">()))</span>

<div class="viewcode-block" id="PartitionedTable.transform"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.transform">[docs]</a>    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Table</span><span class="p">],</span> <span class="n">Table</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">"""Apply the provided function to all constituent Tables and produce a new PartitionedTable with the results</span>
<span class="sd">        as its constituents, with the same data for all other columns in the underlying partitioned Table. Note that</span>
<span class="sd">        if the Table underlying this PartitionedTable changes, a corresponding change will propagate to the result.</span>

<span class="sd">        Args:</span>
<span class="sd">            func (Callable[[Table], Table]: a function which takes a Table as input and returns a new Table</span>

<span class="sd">        Returns:</span>
<span class="sd">            a PartitionedTable</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">j_operator</span> <span class="o">=</span> <span class="n">j_unary_operator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">from_jtype</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">j_object_type</span><span class="o">.</span><span class="n">jclass</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">j_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">j_operator</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="n">j_pt</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to transform the PartitionedTable."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTable.partitioned_transform"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.partitioned_transform">[docs]</a>    <span class="k">def</span> <span class="nf">partitioned_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">PartitionedTable</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Table</span><span class="p">,</span> <span class="n">Table</span><span class="p">],</span> <span class="n">Table</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTable</span><span class="p">:</span>
        <span class="sd">"""Join the underlying partitioned Tables from this PartitionedTable and other on the key columns, then apply</span>
<span class="sd">        the provided function to all pairs of constituent Tables with the same keys in order to produce a new</span>
<span class="sd">        PartitionedTable with the results as its constituents, with the same data for all other columns in the</span>
<span class="sd">        underlying partitioned Table from this.</span>

<span class="sd">        Note that if the Tables underlying this PartitionedTable or other change, a corresponding change will propagate</span>
<span class="sd">        to the result.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (PartitionedTable): the other Partitioned table whose constituent tables will be passed in as the 2nd</span>
<span class="sd">                argument to the provided function</span>
<span class="sd">            func (Callable[[Table, Table], Table]: a function which takes two Tables as input and returns a new Table</span>

<span class="sd">        Returns:</span>
<span class="sd">            a PartitionedTable</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">j_operator</span> <span class="o">=</span> <span class="n">j_binary_operator</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">from_jtype</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">j_object_type</span><span class="o">.</span><span class="n">jclass</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
                <span class="n">j_pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">partitionedTransform</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="p">,</span> <span class="n">j_operator</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="n">j_pt</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"failed to transform the PartitionedTable with another PartitionedTable."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTable.proxy"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTable.proxy">[docs]</a>    <span class="k">def</span> <span class="nf">proxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">require_matching_keys</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sanity_check_joins</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Makes a proxy that allows table operations to be applied to the constituent tables of this</span>
<span class="sd">        PartitionedTable.</span>

<span class="sd">        Args:</span>
<span class="sd">            require_matching_keys (bool): whether to ensure that both partitioned tables have all the same keys</span>
<span class="sd">                present when an operation uses this PartitionedTable and another PartitionedTable as inputs for a</span>
<span class="sd">                :meth:`~PartitionedTable.partitioned_transform`, default is True</span>
<span class="sd">            sanity_check_joins (bool): whether to check that for proxied join operations, a given join key only occurs</span>
<span class="sd">            in exactly one constituent table of the underlying partitioned table. If the other table argument is also a</span>
<span class="sd">            PartitionedTableProxy, its constituents will also be subjected to this constraint.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
            <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_partitioned_table</span><span class="o">.</span><span class="n">proxy</span><span class="p">(</span><span class="n">require_matching_keys</span><span class="p">,</span> <span class="n">sanity_check_joins</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="PartitionedTableProxy"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy">[docs]</a><span class="k">class</span> <span class="nc">PartitionedTableProxy</span><span class="p">(</span><span class="n">JObjectWrapper</span><span class="p">):</span>
    <span class="sd">"""A PartitionedTableProxy is a table operation proxy for the underlying partitioned table. It provides methods</span>
<span class="sd">    that apply table operations to the constituent tables of the underlying partitioned table, produce a new</span>
<span class="sd">    partitioned table from the resulting constituent tables, and return a proxy of it.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        target (PartitionedTable): the underlying partitioned table of the proxy</span>
<span class="sd">        require_matching_keys (bool): whether to ensure that both partitioned tables have all the same keys</span>
<span class="sd">            present when an operation uses this PartitionedTable and another PartitionedTable as inputs for a</span>
<span class="sd">            :meth:`~PartitionedTable.partitioned_transform`, default is True</span>
<span class="sd">        sanity_check_joins (bool): whether to check that for proxied join operations, a given join key only occurs</span>
<span class="sd">            in exactly one constituent table of the underlying partitioned table. If the other table argument is also a</span>
<span class="sd">            PartitionedTableProxy, its constituents will also be subjected to this constraint.</span>
<span class="sd">    """</span>
    <span class="n">j_object_type</span> <span class="o">=</span> <span class="n">_JPartitionedTableProxy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">j_object</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jpy</span><span class="o">.</span><span class="n">JType</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_refreshing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""Whether this proxy represents a refreshing partitioned table."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">is_refreshing</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j_pt_proxy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="p">,</span> <span class="n">_JPartitionedTableProxy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_matching_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">requiresMatchingKeys</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sanity_check_joins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">sanityChecksJoins</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">PartitionedTable</span><span class="p">(</span><span class="n">j_partitioned_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">target</span><span class="p">())</span>

<div class="viewcode-block" id="PartitionedTableProxy.head"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.head">[docs]</a>    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.head` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the head of the constituent tables</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">num_rows</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"head operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.tail"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.tail">[docs]</a>    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.tail` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_rows (int): the number of rows at the end of the constituent tables</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">num_rows</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"tail operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.reverse"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.reverse">[docs]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.reverse` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">reverse</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"reverse operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.snapshot"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.snapshot">[docs]</a>    <span class="k">def</span> <span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_table</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">PartitionedTableProxy</span><span class="p">],</span> <span class="n">do_init</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.snapshot` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table with the provided source table or PartitionedTableProxy, and produces a new</span>
<span class="sd">        PartitionedTableProxy with the result tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        In the case of source table being another PartitionedTableProxy, the :meth:`~Table.snapshot` table operation</span>
<span class="sd">        is applied to the matching pairs of the constituent tables from both underlying partitioned tables.</span>

<span class="sd">        Note, the constituent tables are often time tables that add new rows at a regular, user-defined interval.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_table (Union[Table, PartitionedTableProxy]): the table or PartitionedTableProxy to be snapshot</span>
<span class="sd">            do_init (bool): whether to snapshot when this method is initially called, default is False</span>
<span class="sd">            cols (Union[str, List[str]]): names of the columns of the constituent table to be included in the snapshot,</span>
<span class="sd">                default is None, meaning all the columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="n">table_op</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">source_table</span><span class="o">.</span><span class="n">j_object</span><span class="p">,</span> <span class="n">_JTableOperations</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">snapshot</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="n">do_init</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"snapshot operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.sort"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
             <span class="n">order</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SortDirection</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">SortDirection</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.sort` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            order_by (Union[str, Sequence[str]]): the column(s) to be sorted on</span>
<span class="sd">            order (Union[SortDirection, Sequence[SortDirection], optional): the corresponding sort directions for</span>
<span class="sd">                each sort column, default is None, meaning ascending order for all the sort columns.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">order_by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">order</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="n">SortDirection</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"The number of sort columns must be the same as the number of sort directions."</span><span class="p">)</span>

            <span class="n">sort_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sort_column</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">dir_</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">order_by</span><span class="p">,</span> <span class="n">order</span><span class="p">)]</span>
            <span class="n">j_sc_list</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">sort_columns</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">j_sc_list</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"sort operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.sort_descending"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.sort_descending">[docs]</a>    <span class="k">def</span> <span class="nf">sort_descending</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.sort_descending` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            order_by (Union[str, Sequence[str]]): the column(s) to be sorted on</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">order_by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">order_by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">sortDescending</span><span class="p">(</span><span class="o">*</span><span class="n">order_by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"sort_descending operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.where"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.where">[docs]</a>    <span class="k">def</span> <span class="nf">where</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Filter</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Filter</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.where` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            filters (Union[str, Filter, Sequence[str], Sequence[Filter]], optional): the filter condition</span>
<span class="sd">                expression(s) or Filter object(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filters</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">*</span><span class="n">filters</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"where operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.where_in"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.where_in">[docs]</a>    <span class="k">def</span> <span class="nf">where_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.where_in` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table with the provided filter table, and produces a new PartitionedTableProxy with the result</span>
<span class="sd">        tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_table (Table): the table containing the set of values to filter on</span>
<span class="sd">            cols (Union[str, Sequence[str]]): the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">whereIn</span><span class="p">(</span><span class="n">filter_table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"where_in operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.where_not_in"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.where_not_in">[docs]</a>    <span class="k">def</span> <span class="nf">where_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">:</span> <span class="n">Table</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.where_not_in` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table with the provided filter table, and produces a new PartitionedTableProxy with the result</span>
<span class="sd">        tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_table (Table): the table containing the set of values to filter on</span>
<span class="sd">            cols (Union[str, Sequence[str]]): the column name(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">whereNotIn</span><span class="p">(</span><span class="n">filter_table</span><span class="o">.</span><span class="n">j_table</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"where_not_in operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.view"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.view">[docs]</a>    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.view` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"view operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.update_view"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.update_view">[docs]</a>    <span class="k">def</span> <span class="nf">update_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.update_view` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">updateView</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"update_view operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.update"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.update` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]]): the column formula(s)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"update operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.select"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.select">[docs]</a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.select` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]], optional): the column formula(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"select operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.select_distinct"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.select_distinct">[docs]</a>    <span class="k">def</span> <span class="nf">select_distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formulas</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.select_distinct` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            formulas (Union[str, Sequence[str]], optional): the column formula(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">formulas</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">formulas</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">_query_scope_ctx</span><span class="p">(),</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">selectDistinct</span><span class="p">(</span><span class="o">*</span><span class="n">formulas</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"select_distinct operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.natural_join"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.natural_join">[docs]</a>    <span class="k">def</span> <span class="nf">natural_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">PartitionedTableProxy</span><span class="p">],</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
                     <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.natural_join` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table with the provided right table or PartitionedTableProxy, and produces a new</span>
<span class="sd">        PartitionedTableProxy with the result tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        In the case of the right table being another PartitionedTableProxy, the :meth:`~Table.natural_join` table</span>
<span class="sd">        operation is applied to the matching pairs of the constituent tables from both underlying partitioned tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Union[Table, PartitionedTableProxy]): the right table or PartitionedTableProxy of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="n">table_op</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_object</span><span class="p">,</span> <span class="n">_JTableOperations</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
                        <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">naturalJoin</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">),</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joins</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
                        <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">naturalJoin</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"natural_join operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.exact_join"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.exact_join">[docs]</a>    <span class="k">def</span> <span class="nf">exact_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">PartitionedTableProxy</span><span class="p">],</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
                   <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.exact_join` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table with the provided right table or PartitionedTableProxy,and produces a new</span>
<span class="sd">        PartitionedTableProxy with the result tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        In the case of the right table being another PartitionedTableProxy, the :meth:`~Table.exact_join` table</span>
<span class="sd">        operation is applied to the matching pairs of the constituent tables from both underlying partitioned tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Union[Table, PartitionedTableProxy]): the right table or PartitionedTableProxy of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="n">table_op</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_object</span><span class="p">,</span> <span class="n">_JTableOperations</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
                        <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">exactJoin</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">),</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joins</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
                        <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">exactJoin</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"exact_join operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.join"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">PartitionedTableProxy</span><span class="p">],</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.join` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table with the provided right table or PartitionedTableProxy, and produces a new PartitionedTableProxy with</span>
<span class="sd">        the result tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        In the case of the right table being another PartitionedTableProxy, the :meth:`~Table.join` table operation</span>
<span class="sd">        is applied to the matching pairs of the constituent tables from both underlying partitioned tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Union[Table, PartitionedTableProxy]): the right table or PartitionedTableProxy of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names; default is None</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="n">table_op</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_object</span><span class="p">,</span> <span class="n">_JTableOperations</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
                        <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">),</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">joins</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span>
                        <span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="s2">","</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">on</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"join operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.aj"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.aj">[docs]</a>    <span class="k">def</span> <span class="nf">aj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">PartitionedTableProxy</span><span class="p">],</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
           <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
           <span class="n">match_rule</span><span class="p">:</span> <span class="n">AsOfMatchRule</span> <span class="o">=</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">LESS_THAN_EQUAL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.aj` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table with the provided right table or PartitionedTableProxy, and produces a new PartitionedTableProxy with</span>
<span class="sd">        the result tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        In the case of the right table being another PartitionedTableProxy, the :meth:`~Table.aj` table operation</span>
<span class="sd">        is applied to the matching pairs of the constituent tables from both underlying partitioned tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Union[Table, PartitionedTableProxy]): the right table or PartitionedTableProxy of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>
<span class="sd">            match_rule (AsOfMatchRule): the inexact matching rule on the last column to match specified in 'on',</span>
<span class="sd">                default is AsOfMatchRule.LESS_THAN_EQUAL. The other valid value is AsOfMatchRule.LESS_THAN.</span>
<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">on</span><span class="p">:</span>
                <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JJoinMatch</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                <span class="n">joins</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JJoinAddition</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">]</span>

            <span class="n">on</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="n">table_op</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_object</span><span class="p">,</span> <span class="n">_JTableOperations</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match_rule</span> <span class="ow">is</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">LESS_THAN_EQUAL</span><span class="p">:</span>
                <span class="n">match_rule</span> <span class="o">=</span> <span class="n">_JAsOfJoinRule</span><span class="o">.</span><span class="n">LESS_THAN_EQUAL</span>
            <span class="k">elif</span> <span class="n">match_rule</span> <span class="ow">is</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">LESS_THAN</span><span class="p">:</span>
                <span class="n">match_rule</span> <span class="o">=</span> <span class="n">_JAsOfJoinRule</span><span class="o">.</span><span class="n">LESS_THAN</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"invalid match_rule value"</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">aj</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">match_rule</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"as-of join operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.raj"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.raj">[docs]</a>    <span class="k">def</span> <span class="nf">raj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">PartitionedTableProxy</span><span class="p">],</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
            <span class="n">joins</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">match_rule</span><span class="p">:</span> <span class="n">AsOfMatchRule</span> <span class="o">=</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">GREATER_THAN_EQUAL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.raj` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table with the provided right table or PartitionedTableProxy, and produces a new PartitionedTableProxy with</span>
<span class="sd">        the result tables as the constituents of its underlying partitioned table.</span>

<span class="sd">        In the case of the right table being another PartitionedTableProxy, the :meth:`~Table.raj` table operation</span>
<span class="sd">        is applied to the matching pairs of the constituent tables from both underlying partitioned tables.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (Union[Table, PartitionedTableProxy]): the right table or PartitionedTableProxy of the join</span>
<span class="sd">            on (Union[str, Sequence[str]]): the column(s) to match, can be a common name or an equal expression,</span>
<span class="sd">                i.e. "col_a = col_b" for different column names</span>
<span class="sd">            joins (Union[str, Sequence[str]], optional): the column(s) to be added from the right table to the result</span>
<span class="sd">                table, can be renaming expressions, i.e. "new_col = col"; default is None</span>
<span class="sd">            match_rule (AsOfMatchRule): the inexact matching rule on the last column to match specified in 'on',</span>
<span class="sd">                default is AsOfMatchRule.GREATER_THAN_EQUAL. The other valid value is AsOfMatchRule.GREATER_THAN.</span>
<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">on</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">on</span><span class="p">:</span>
                <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JJoinMatch</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">on</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">joins</span><span class="p">:</span>
                <span class="n">joins</span> <span class="o">=</span> <span class="p">[</span><span class="n">_JJoinAddition</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">]</span>

            <span class="n">on</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">(</span><span class="n">joins</span><span class="p">)</span>
            <span class="n">table_op</span> <span class="o">=</span> <span class="n">jpy</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">j_object</span><span class="p">,</span> <span class="n">_JTableOperations</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match_rule</span> <span class="ow">is</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">GREATER_THAN_EQUAL</span><span class="p">:</span>
                <span class="n">match_rule</span> <span class="o">=</span> <span class="n">_JReverseAsOfJoinRule</span><span class="o">.</span><span class="n">GREATER_THAN_EQUAL</span>
            <span class="k">elif</span> <span class="n">match_rule</span> <span class="ow">is</span> <span class="n">AsOfMatchRule</span><span class="o">.</span><span class="n">GREATER_THAN</span><span class="p">:</span>
                <span class="n">match_rule</span> <span class="o">=</span> <span class="n">_JReverseAsOfJoinRule</span><span class="o">.</span><span class="n">GREATER_THAN</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"invalid match_rule value"</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">raj</span><span class="p">(</span><span class="n">table_op</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">match_rule</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"reverse as-of join operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.group_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.group_by">[docs]</a>    <span class="k">def</span> <span class="nf">group_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.group_by` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">groupBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"group-by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.agg_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.agg_by">[docs]</a>    <span class="k">def</span> <span class="nf">agg_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aggs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Aggregation</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Aggregation</span><span class="p">]],</span>
               <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.agg_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            aggs (Union[Aggregation, Sequence[Aggregation]]): the aggregation(s)</span>
<span class="sd">            by (Union[str, Sequence[str]]): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">aggs</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">aggs</span><span class="p">)</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="n">j_agg_list</span> <span class="o">=</span> <span class="n">j_array_list</span><span class="p">([</span><span class="n">agg</span><span class="o">.</span><span class="n">j_aggregation</span> <span class="k">for</span> <span class="n">agg</span> <span class="ow">in</span> <span class="n">aggs</span><span class="p">])</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">aggBy</span><span class="p">(</span><span class="n">j_agg_list</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"agg_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.agg_all_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.agg_all_by">[docs]</a>    <span class="k">def</span> <span class="nf">agg_all_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agg</span><span class="p">:</span> <span class="n">Aggregation</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.agg_all_by` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Note, because agg_all_by applies the aggregation to all the columns of the table, it will ignore</span>
<span class="sd">        any column names specified for the aggregation.</span>

<span class="sd">        Args:</span>
<span class="sd">            agg (Aggregation): the aggregation</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">aggAllBy</span><span class="p">(</span><span class="n">agg</span><span class="o">.</span><span class="n">j_agg_spec</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"agg_all_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.count_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.count_by">[docs]</a>    <span class="k">def</span> <span class="nf">count_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.count_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table with the provided source table, and produces a new PartitionedTableProxy with the result tables as the</span>
<span class="sd">        constituents of its underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            col (str): the name of the column to store the counts</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">countBy</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">countBy</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"count_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.first_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.first_by">[docs]</a>    <span class="k">def</span> <span class="nf">first_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.first_by` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">firstBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">firstBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"first_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.last_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.last_by">[docs]</a>    <span class="k">def</span> <span class="nf">last_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.last_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">lastBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">lastBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"last_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.min_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.min_by">[docs]</a>    <span class="k">def</span> <span class="nf">min_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.min_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">minBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">minBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"min_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.max_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.max_by">[docs]</a>    <span class="k">def</span> <span class="nf">max_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.max_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">maxBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">maxBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"max_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.sum_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.sum_by">[docs]</a>    <span class="k">def</span> <span class="nf">sum_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.sum_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">sumBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">sumBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"sum_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.abs_sum_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.abs_sum_by">[docs]</a>    <span class="k">def</span> <span class="nf">abs_sum_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.abs_sum_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">absSumBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">absSumBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"sum_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.weighted_sum_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.weighted_sum_by">[docs]</a>    <span class="k">def</span> <span class="nf">weighted_sum_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wcol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.weighted_sum_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            wcol (str): the name of the weight column</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">wsumBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">wsumBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"sum_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.avg_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.avg_by">[docs]</a>    <span class="k">def</span> <span class="nf">avg_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.avg_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">avgBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">avgBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"avg_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.weighted_avg_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.weighted_avg_by">[docs]</a>    <span class="k">def</span> <span class="nf">weighted_avg_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wcol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.weighted_avg_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            wcol (str): the name of the weight column</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">wavgBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">,</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">avgBy</span><span class="p">(</span><span class="n">wcol</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"avg_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.median_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.median_by">[docs]</a>    <span class="k">def</span> <span class="nf">median_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.median_by` table operation to all constituent tables of the underlying</span>
<span class="sd">        partitioned table, and produces a new PartitionedTableProxy with the result tables as the constituents of its</span>
<span class="sd">        underlying partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">medianBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">medianBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"median_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.std_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.std_by">[docs]</a>    <span class="k">def</span> <span class="nf">std_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.std_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">stdBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">stdBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"std_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.var_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.var_by">[docs]</a>    <span class="k">def</span> <span class="nf">var_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.var_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            by (Union[str, Sequence[str]], optional): the group-by column name(s), default is None</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">by</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">varBy</span><span class="p">(</span><span class="o">*</span><span class="n">by</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">varBy</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"var_by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>

<div class="viewcode-block" id="PartitionedTableProxy.update_by"><a class="viewcode-back" href="../../code/deephaven.table.html#deephaven.table.PartitionedTableProxy.update_by">[docs]</a>    <span class="k">def</span> <span class="nf">update_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ops</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">UpdateByOperation</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">UpdateByOperation</span><span class="p">]],</span>
                  <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionedTableProxy</span><span class="p">:</span>
        <span class="sd">"""Applies the :meth:`~Table.update_by` table operation to all constituent tables of the underlying partitioned</span>
<span class="sd">        table, and produces a new PartitionedTableProxy with the result tables as the constituents of its underlying</span>
<span class="sd">        partitioned table.</span>

<span class="sd">        Args:</span>
<span class="sd">            ops (Union[UpdateByOperation, List[UpdateByOperation]]): the update-by operation definition(s)</span>
<span class="sd">            by (Union[str, List[str]]): the key column name(s) to group the rows of the table</span>

<span class="sd">        Returns:</span>
<span class="sd">            a new PartitionedTableProxy</span>

<span class="sd">        Raises:</span>
<span class="sd">            DHError</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ops</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span>
            <span class="n">by</span> <span class="o">=</span> <span class="n">to_sequence</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">auto_locking_ctx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PartitionedTableProxy</span><span class="p">(</span><span class="n">j_pt_proxy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">j_pt_proxy</span><span class="o">.</span><span class="n">updateBy</span><span class="p">(</span><span class="n">j_array_list</span><span class="p">(</span><span class="n">ops</span><span class="p">),</span> <span class="o">*</span><span class="n">by</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DHError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">"update-by operation on the PartitionedTableProxy failed."</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div></div>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Deephaven Data Labs |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    </body>
</html>